<!DOCTYPE html> 
<html lang ="en">  
<head>  
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Mikitz' Battle Map Generator</title>  
    <!-- ICONS -->
    <script src="https://kit.fontawesome.com/7e282d14cd.js" crossorigin="anonymous"></script>
    <link href='https://fonts.googleapis.com/css?family=Quicksand' rel='stylesheet'>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.8.3/font/bootstrap-icons.css">
    <!-- STYLESHEETS -->
    <link rel="stylesheet" href="/mikitz-ttrpg/css/styles.min.css"/>
    <!-- MAIN -->
    <script src="/mikitz-ttrpg/js/library/weather.js"></script>
    <script src="/mikitz-ttrpg/js/library/global.js"></script>
    <script src="/mikitz-ttrpg/js/battleMap.js"></script>
    <!-- LIBRARIES -->
    <script src="https://unpkg.com/@popperjs/core@2"></script>
    <script src="https://unpkg.com/tippy.js@6"></script>
    <script src="https://code.jquery.com/jquery-3.6.0.js"></script>
    <script src="https://unpkg.com/dexie/dist/dexie.js"></script>
    <script type="text/javascript" src="https://cdn.jsdelivr.net/npm/toastify-js"></script>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/jsgrid/1.5.3/jsgrid.min.js"></script>
    <!-- TABLES -->
    <script src="/mikitz-ttrpg/data/js-data/battle-map-generator/selectsData.js"></script>
    <script src="/mikitz-ttrpg/data/version_numbers.js"></script>
</head> 
<body>
    <div class="site-nav">
        <a class="site-button" id="index" href="/mikitz-ttrpg/index.html"><i class="fa-solid fa-house"></i><span>Home</span></a>
        <a class="site-button-active" id="battle-map-generator" href="/mikitz-ttrpg/html/pages/battle-map-generator.html"><i class="fa-solid fa-map"></i><span>Battle Map</span></a>
        <a class="site-button-under-construction" id="calendar"><i class="fa-solid fa-calendar"></i><span>Calendar</span></a>
        <a class="site-button" id="encounter-generator" href="/mikitz-ttrpg/html/pages/encounter-generator.html"><i class="fa-solid fa-location-dot"></i><span>Encounter</span></a> 
        <a class="site-button" id="magic-shop-generator" href="/mikitz-ttrpg/html/pages/magic-shop-generator.html"><i class="fa-solid fa-store"></i><span>Magic Shop</span></a>
        <a class="site-button" id="npc-generator" href="/mikitz-ttrpg/html/pages/npc-generator.html"><i class="fa-solid fa-person-half-dress"></i><span>NPC</span></a>
        <a class="site-button" id="spellbook-generator" href="/mikitz-ttrpg/html/pages/spellbook-generator.html"><i class="fa-solid fa-book"></i><span>Spellbook</span></a>
        <a class="site-button-under-construction" id="star-system-and-galaxy-generator" href="/mikitz-ttrpg/html/pages/star-system-and-galaxy-generator.html"><i class="fa-regular fa-circle-dot"></i><span>System</span></a>
        <a class="site-button-under-construction" id="world-generator" href="/mikitz-ttrpg/html/pages/world-generator.html"><i class="fa-solid fa-earth-americas"></i><span>World</span></a>
        <span class="right">
            <a class="site-button" id="settings" href="/mikitz-ttrpg/html/settings.html"><i class="fa-solid fa-gear"></i><span>Settings</span></a>
            <a class="site-button" id="wiki" href="/mikitz-ttrpg/html/wiki.html"><i class="fa-solid fa-book-open"></i><span>Wiki</span></a>
        </span>
    </div>
    <div class="sub-nav" id="sub-nav">
        <a class="sub-nav-version-number nav-a" style="text-decoration: underline;" id="version-link" href="" target="_blank" rel="noopener noreferrer">
            <i class="fa-solid fa-code-commit" style="margin-right: 0.5rem;"></i>
            <span id="version-number"></span>
        </a>
        <a href="#" class="nav-a active"><i class="fa-solid fa-dice-d20"></i> <span>Generator</span></a>
    </div>
    <main>
        <div class="container">
            <div class="left-panel">
                <div class="user-options">
                    <!-- Name and Load -->
                    <fieldset class="user-options-container">
                        <legend class="fieldset-legend">Attributes <i class="fa-solid fa-caret-down"></i></legend>
                        <div class="fieldset-content visible">
                            <div class="text-input-container">
                                <label class="text-input-label">Name</label>
                                <input class="text-input" placeholder="Auto-named Map ###" type="text" id="name">
                            </div>
                            <div class="select-container">
                                <label class="select-label">Load</label>
                                <select class="select-dropdown" id="map-history-dropdown">
                                    <option value="choose">Select Map...</option>
                                </select>
                            </div>
                            <div class="upload-file-container">
                                <label class="upload-file-label">JSON</label>
                                <input class="upload-file-input" style="display: inline;" type="file" id="json-input" accept="application/JSON">
                            </div>
                        </div>
                    </fieldset>
                    <!-- Dimensions -->
                    <fieldset class="user-options-container">
                        <legend class="fieldset-legend">Dimensions <i class="fa-solid fa-caret-down"></i></legend>
                        <div class="fieldset-content visible">
                            <div class="radio-input-container">
                                <label class="radio-input-label"><i id="direction-help" class="bi bi-question-square"></i>Direction</label>
                                <label for="vertical"><i class="fa-solid fa-arrows-up-down"></i></label>
                                    <input type="radio" name="orientation" id="vertical" value="vertical" checked>
                                <label for="horizontal"><i class="fa-solid fa-arrows-left-right"></i></label>
                                    <input type="radio" name="orientation" id="horizontal" value="horizontal">
                            </div>
                            <div class="number-input-container">
                                <label class="number-input-label">Height</label>
                                <input class="number-input" name="resolution" value="10" type="number" max="200" min="1" step="1" id="height-input">
                                <span class="calculated-value" id="height-pixels"> 7,000 pixels</span>
                            </div>
                            <div class="number-input-container">
                                <label class="number-input-label">Width</label>
                                <input class="number-input" name="resolution" value="10" type="number" max="200" min="1" step="1" id="width-input">
                                <span class="calculated-value" id="width-pixels"> 7,000 pixels</span>
                            </div>
                            <div class="number-input-container">
                                <label class="number-input-label">Grid Size</label>
                                <input class="number-input" name="resolution" value="50" type="number" max="200" min="1" step="1" id="grid-size">
                            </div>
                            <div class="text-display-container">
                                <label class="text-display-label">Totals</label>
                                <span class="text-display">
                                    <span id="total-tiles">100</span>
                                    <span class="text-display-type">tiles</span>
                                </span>
                                <span class="text-display">
                                    <span id="total-pixels">490,000</span>
                                    <span class="text-display-type">pixels</span>
                                </span>
                            </div>
                        </div>
                    </fieldset>
                    <!-- Environment -->
                    <fieldset class="user-options-container">
                        <legend class="fieldset-legend">Environment <i class="fa-solid fa-caret-down"></i></legend>
                        <div class="fieldset-content visible">
                            <div class="select-container">
                                <label class="select-label"><i id="biome-help" class="bi bi-question-square"></i>Biome</label>
                                <select class="select-dropdown" id="biome"></select>
                            </div>
                            <div class="select-container">
                                <label class="select-label"><i id="climate-help" class="bi bi-question-square"></i>Climate</label>
                                <select class="select-dropdown" id="climate"></select>
                            </div>
                            <div class="select-container">
                                <label class="select-label"><i id="form-help" class="bi bi-question-square"></i>Landform</label>
                                <select class="select-dropdown" id="form"></select>
                            </div>
                            <div class="select-container">
                                <label class="select-label"><i id="plane-help" class="bi bi-question-square"></i>Plane</label>
                                <select class="select-dropdown" id="plane"></select>
                            </div>
                            <div class="select-container">
                                <label class="select-label"><i id="season-help" class="bi bi-question-square"></i>Season</label>
                                <select class="select-dropdown" id="season"></select>
                            </div>
                        </div>
                    </fieldset>
                    <!-- Grid -->
                    <fieldset class="user-options-container">
                        <legend class="fieldset-legend">Grid <i class="fa-solid fa-caret-down"></i></legend>
                        <div class="fieldset-content visible">
                            <div class="radio-input-container">
                                <label class="radio-input-label">Grid Type</label>
                                <label for="square"><i class="bi bi-square-fill"></i></label>
                                    <input type="radio" name="grid-type" id="square" value="square" checked>
                                <label for="hex"><i class="bi bi-hexagon-fill"></i></label>
                                    <input type="radio" name="grid-type" id="hex" value="hex">
                            </div>
                            <div class="select-container">
                                <label class="select-label">Hex Type</label>
                                <select class="select-dropdown" id="hex-type"></select>
                            </div>
                            <div class="checkbox-container">
                                <input class="checkbox" type="checkbox">
                                <label class="checkbox-label" id="grid-lines">Grid Lines</label>
                                <label class="line-width-select-label" for="line-width" id="line-width-label" style="font-size: smaller; display: none;">Width</label>
                                <select class="line-width-select" name="line-width" id="line-width" style="display: none;">
                                    <option value="1" selected>1</option>
                                    <option value="2">2</option>
                                    <option value="3">3</option>
                                    <option value="4">4</option>
                                    <option value="5">5</option>
                                    <option value="6">6</option>
                                    <option value="7">7</option>
                                    <option value="8">8</option>
                                    <option value="9">9</option>
                                    <option value="10">10</option>
                                </select>
                            </div>
                        </div>
                    </fieldset>
                </div>
            </div>
            <div class="center-column">
                <div class="battle-map-output">
                    <div id="legend" class="legend"></div>
                    <div class="battle-map-canvas-container" id="battle-map-canvas-container">
                        <canvas id="battle-map"></canvas>
                    </div>
                </div>
                <div class="buttons">
                    <button class="button" id="generate" style="margin-top: 5px;"><span class="button-text"><i class="fa-solid fa-dice"></i></i></span></button>
                    <button id="clear-canvas" class="button" style="margin-top: 5px;"><span class="button-text"><i class="fa-solid fa-x"></i></span></button>
                    <button id="export-webp" class="button" style="margin-top: 5px;"><span class="button-text real-text"><i class="bi bi-file-earmark-image"></i>WEBP</span></button>
                    <button id="export-png" class="button" style="margin-top: 5px;"><span class="button-text real-text"><i class="bi bi-file-earmark-image"></i>PNG</span></button>
                    <button id="export-json" class="button" style="margin-top: 5px;"><span class="button-text real-text"><i class="bi bi-file-code"></i>JSON</span></button>
                    <button id="export-uvtt" class="button" style="margin-top: 5px;"><span class="button-text real-text"><i class="bi bi-file-code"></i>UVTT</span></button>
                    <button id="export-fvtt" class="button" style="margin-top: 5px;"><span class="button-text real-text"><i class="bi bi-file-code"></i>FVTT</span></button>
                    <button id="toggle-visibility" class="button" style="margin-top: 5px;"><span class="button-text"><i class="fa-solid fa-angles-down"></i></span></button>
                </div>
            </div>
            <div class="right-panel">
                <div class="user-options">
                    <!-- Tile Labels -->
                    <fieldset  class="user-options-container">
                        <legend class="fieldset-legend">Tile Labels <i class="fa-solid fa-caret-down"></i></legend>
                        <div class="fieldset-content visible">
                            <div class="checkbox-container">
                                <input class="checkbox" type="checkbox" id="terrain-checkbox" name="label-checkbox">
                                <label class="checkbox-label">Terrain</label>
                                <label id="terrain-opacity-label" style="font-size: smaller; display: none;">Opacity</label>
                                <input id="terrain-opacity-input" class="opacity-input" style="display: none;" type="number" min="0" max="1" value="1" step="0.1">
                            </div>
                            <div class="checkbox-container">
                                <input class="checkbox" type="checkbox" id="coordinates-checkbox" name="label-checkbox">
                                <label class="checkbox-label">Coordinates</label>
                                <label id="coordinates-opacity-label" style="font-size: smaller; display: none;">Opacity</label>
                                <input id="coordinates-opacity-input" class="opacity-input" style="display: none;" type="number" min="0" max="1" value="1" step="0.1">
                            </div>
                            <div class="checkbox-container">
                                <input class="checkbox" type="checkbox" id="cover-checkbox" name="label-checkbox" checked>
                                <label class="checkbox-label">Cover</label>
                                <label id="cover-opacity-label" style="font-size: smaller; display: none;">Opacity</label>
                                <input id="cover-opacity-input" class="opacity-input" style="display: none;" type="number" min="0" max="1" value="1" step="0.1">
                            </div>
                            <div class="checkbox-container">
                                <input class="checkbox" type="checkbox" id="elevation-checkbox" name="label-checkbox" checked>
                                <label class="checkbox-label">Elevation</label>
                                <label id="elevation-opacity-label" style="font-size: smaller; display: none;">Opacity</label>
                                <input id="elevation-opacity-input" class="opacity-input" style="display: none;" type="number" min="0" max="1" value="1" step="0.1">
                            </div>
                        </div>
                    </fieldset>
                    <!-- Terrain -->
                    <fieldset class="user-options-container">
                        <legend class="fieldset-legend">Terrain <i class="fa-solid fa-caret-down"></i></legend>
                        <div class="fieldset-content visible">
                            <div class="slider-container">
                                <label class="slider-label"><i id="terrain-help" class="bi bi-question-square"></i>Terrain</label>
                                <input class="slider-number" id="regular-terrain-input" type="number" min="0" max="100" value="0" step="1">
                                <input class="slider" id="regular-terrain-slider" type="range" min="0" max="100" value="0" step="1">
                            </div>
                            <div class="slider-container">
                                <label class="slider-label"><i id="difficult-terrain-help" class="bi bi-question-square"></i>Diff. Trn.</label>
                                <input class="slider-number" id="difficult-terrain-input" type="number" min="0" max="100" value="0" step="1">
                                <input class="slider" id="difficult-terrain-slider" type="range" min="0" max="100" value="0" step="1">
                            </div>
                            <div class="slider-container">
                                <label class="slider-label"><i id="cover-help" class="bi bi-question-square"></i>Cover</label>
                                <input class="slider-number" id="cover-input" type="number" min="0" max="100" value="0" step="1">
                                <input class="slider" id="cover-slider" type="range" min="0" max="100" value="0" step="1">
                            </div>
                        </div>
                    </fieldset>
                    <!-- Features -->
                    <fieldset class="user-options-container">
                        <legend class="fieldset-legend">Features <i class="fa-solid fa-caret-down"></i></legend>
                        <div class="fieldset-content visible">
                            <div class="slider-container">
                                <label class="slider-label"><i id="cliffs-help" class="bi bi-question-square"></i>Cliffs</label>
                                <input class="slider-number" id="cliffs-input" type="number" min="0" max="100" value="0" step="1">
                                <input class="slider" id="cliffs-slider" type="range" min="0" max="100" value="0" step="1">
                            </div>
                            <div class="slider-container">
                                <label class="slider-label"><i id="hills-help" class="bi bi-question-square"></i>Hills</label>
                                <input class="slider-number" id="hills-input" type="number" min="0" max="100" value="0" step="1">
                                <input class="slider" id="hills-slider" type="range" min="0" max="100" value="0" step="1">
                            </div>
                            <div class="slider-container">
                                <label class="slider-label"><i id="lake-help" class="bi bi-question-square"></i>Lake</label>
                                <input class="slider-number" id="lake-input" type="number" min="0" max="100" value="0" step="1">
                                <input class="slider" id="lake-slider" type="range" min="0" max="100" value="0" step="1">
                            </div>
                            <div class="slider-container">
                                <label class="slider-label"><i id="pond-help" class="bi bi-question-square"></i>Pond</label>
                                <input class="slider-number" id="pond-input" type="number" min="0" max="100" value="0" step="1">
                                <input class="slider" id="pond-slider" type="range" min="0" max="100" value="0" step="1">
                            </div>
                            <div class="slider-container">
                                <label class="slider-label"><i id="river-help" class="bi bi-question-square"></i>River</label>
                                <input class="slider-number" id="river-input" type="number" min="0" max="100" value="0" step="1">
                                <input class="slider" id="river-slider" type="range" min="0" max="100" value="0" step="1">
                            </div>
                            <div class="slider-container">
                                <label class="slider-label"><i id="road-help" class="bi bi-question-square"></i>Road</label>
                                <input class="slider-number" id="road-input" type="number" min="0" max="100" value="0" step="1">
                                <input class="slider" id="road-slider" type="range" min="0" max="100" value="0" step="1">
                            </div>
                        </div>
                    </fieldset>
                    <!-- Weather -->
                    <!-- <fieldset class="user-options-container">
                        <legend class="fieldset-legend">Weather <i class="fa-solid fa-caret-down"></i></legend>
                        <div class="fieldset-content visible">
                            <div class="slider-container">
                                <label class="slider-label"><i id="average-temperature-help" class="bi bi-question-square"></i>Temp.</label>
                                <input class="slider-number" id="average-temperature-input" type="number" min="-100" max="150" value="0" step="1">
                                <input class="slider" id="average-temperature-slider" type="range" min="-100" max="150" value="0" step="1">
                            </div>
                            <div class="slider-container">
                                <label class="slider-label"><i id="precipitation-probability-help" class="bi bi-question-square"></i>L. Precip.</label>
                                <input class="slider-number" id="precipitation-probability-input" type="number" min="0" max="100" value="0" step="1">
                                <input class="slider" id="precipitation-probability-slider" type="range" min="0" max="100" value="0" step="1">
                            </div>
                            <div class="slider-container">
                                <label class="slider-label"><i id="heavy-precipitation-probability-help" class="bi bi-question-square"></i>H. Precip.</label>
                                <input class="slider-number" id="heavy-precipitation-probability-input" type="number" min="0" max="100" value="0" step="1">
                                <input class="slider" id="heavy-precipitation-probability-slider" type="range" min="0" max="100" value="0" step="1">
                            </div>
                        </div>
                    </fieldset> -->
                </div>
            </div>            
        </div>
        <a id="downloadAnchorElem" style="display: none; visibility: hidden;"></a>
    </main> 
</body>
<script>
    calculateResolution()
    setupAllDElements()
    localStorage.setItem('collapsed', false)
    setupAllListeners()
    setupTerrain()
    // setupWeather()
    setupFeatures()
    document.getElementById(`cover-opacity-label`).style.display = 'block'
    document.getElementById(`cover-opacity-input`).style.display = 'block'
    document.getElementById(`elevation-opacity-label`).style.display = 'block'
    document.getElementById(`elevation-opacity-input`).style.display = 'block'
</script>
</html>